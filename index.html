<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>VERTUU RENT ‚Ä¢ –†–£–õ–ï–¢–ö–ê –£–î–ê–ß–ò</title>
    <link rel="stylesheet" href="css/reset.css" />
    <link rel="stylesheet" href="css/style.css" />
    <link rel="icon" href="images/logo.jpg" type="image/jpeg" />
    <style>
      * {
        box-sizing: border-box;
      }

      .wheel-section {
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 40px 20px;
      }

      .deal-wheel {
        --size: clamp(250px, 75vmin, 500px);
        --lg-hs: 0 3%;
        --lg-stop: 50%;
        --lg: linear-gradient(
          hsl(var(--lg-hs) 0%) 0 var(--lg-stop),
          hsl(var(--lg-hs) 20%) var(--lg-stop) 100%
        );
        position: relative;
        display: grid;
        grid-gap: calc(var(--size) / 20);
        align-items: center;
        grid-template-areas: "spinner" "trigger";
        font-size: calc(var(--size) / 21);
        margin: 0 auto;
      }

      .deal-wheel > * {
        grid-area: spinner;
      }
      .deal-wheel .btn-spin {
        grid-area: trigger;
        justify-self: center;
      }

      .spinner {
        position: relative;
        display: grid;
        align-items: center;
        grid-template-areas: "spinner";
        width: var(--size);
        height: var(--size);
        border-radius: 50%;
        transform: rotate(calc(var(--rotate, 25) * 1deg));

        /* === –ß–Å–†–ù–ê–Ø –û–ë–í–û–î–ö–ê ‚Äî —É–º–µ–Ω—å—à–µ–Ω–∞ –¥–æ 5px === */
        border: 5px solid #000;
        box-shadow: 0 0 18px rgba(0, 0, 0, 0.9),
          inset 0 0 12px rgba(0, 0, 0, 0.7);

        margin-bottom: 20px;
      }

      .spinner::before {
        /* === –¶–ï–ù–¢–†–ê–õ–¨–ù–´–ô –ö–†–£–ì ‚Äî —É–º–µ–Ω—å—à–µ–Ω === */
        content: "";
        position: absolute;
        top: 50%;
        left: 50%;
        width: calc(var(--size) / 5.5); /* –±—ã–ª /4, —Ç–µ–ø–µ—Ä—å –º–µ–Ω—å—à–µ */
        height: calc(var(--size) / 5.5);
        background: radial-gradient(circle, #ff8c00, #ff6b00, #e65100);
        border-radius: 50%;
        transform: translate(-50%, -50%);
        z-index: 20;
        box-shadow: 0 0 25px rgba(255, 140, 0, 0.7),
          inset 0 0 15px rgba(0, 0, 0, 0.5);
        pointer-events: none;
      }

      .spinner * {
        grid-area: spinner;
      }

      .prize {
        position: relative;
        display: flex;
        align-items: center;
        /* === –¢–ï–ö–°–¢ –ë–õ–ò–ñ–ï –ö –¶–ï–ù–¢–†–£ (–æ—Ç–æ–¥–≤–∏–Ω—É—Ç –æ—Ç –∫—Ä–∞—è) === */
        padding: 0 calc(var(--size) / 6) 0 calc(var(--size) / 10); /* –±—ã–ª /20, —Ç–µ–ø–µ—Ä—å /10 */
        width: 50%;
        height: 50%;
        transform-origin: center right;
        transform: rotate(var(--rotate));
        user-select: none;
        z-index: 10;
      }

      .prize::before {
        top: 0;
      }
      .prize::after {
        bottom: 0;
      }

      /* === –î–ï–õ–ò–¢–ï–õ–¨ ‚Äî —É–≤–µ–ª–∏—á–µ–Ω === */
      .ticker {
        position: relative;
        left: calc(var(--size) / -15);
        width: calc(var(--size) / 8); /* –±—ã–ª /11, —Ç–µ–ø–µ—Ä—å –±–æ–ª—å—à–µ */
        height: calc(var(--size) / 16); /* –±—ã–ª /22, —Ç–µ–ø–µ—Ä—å –≤—ã—à–µ */
        background: var(--lg);
        z-index: 100;
        clip-path: polygon(20% 0, 100% 50%, 20% 100%, 0% 50%);
        transform-origin: center left;
      }

      .btn-spin {
        color: white;
        background: rgba(0, 0, 0, 0.43);
        border: none;
        font-size: inherit;
        padding: 0.9rem 2rem 1rem;
        border-radius: 0.5rem;
        cursor: pointer;
        font-weight: 600;

        font-family: "Russo One", sans-serif;

        transition: all 0.3s ease;
      }

      .btn-spin:hover {
        transform: scale(1.05);
      }
      .btn-spin:disabled {
        cursor: progress;
        opacity: 0.25;
      }

      .is-spinning .spinner {
        transition: transform 8s cubic-bezier(0.1, -0.01, 0, 1);
      }
      .is-spinning .ticker {
        animation: tick 700ms cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
      }

      @keyframes tick {
        0% {
          transform: rotate(0deg);
        }
        40% {
          transform: rotate(-8deg);
        }
        100% {
          transform: rotate(0deg);
        }
      }

      /* === –¢–ï–ù–¨ –¢–ï–ö–°–¢–ê –ö–ê–ö –ù–ê –ü–†–ò–ú–ï–†–ï "–°–∫–∏–¥–∫–∞ 50%" ‚Äî —á—ë—Ä–Ω–∞—è –æ–±—ä—ë–º–Ω–∞—è === */
      .text {
        font-family: "Russo One", sans-serif;
        font-weight: bold;
        color: #ffffff;
        text-shadow: 3px 3px 0 #000, -1px -1px 0 #000, 1px -1px 0 #000,
          -1px 1px 0 #000, 3px 3px 8px rgba(0, 0, 0, 0.8);
      }

      .prize.selected .text {
        color: #ffefb3;
        animation: selected 800ms ease;
      }

      @keyframes selected {
        25% {
          transform: scale(1.25);
          text-shadow: 4px 4px 10px rgba(0, 0, 0, 0.9);
        }
        40% {
          transform: scale(0.92);
        }
        60% {
          transform: scale(1.02);
        }
        75% {
          transform: scale(0.98);
        }
        85% {
          transform: scale(1);
        }
      }

      .roulette__button--secondary:disabled {
        opacity: 0.5;
        cursor: not-allowed;
      }

      /* === –ê–î–ê–ü–¢–ò–í === */
      @media (max-width: 768px) {
        .deal-wheel {
          --size: clamp(240px, 72vmin, 420px);
        }
        .ticker {
          left: calc(var(--size) / -13);
          width: calc(var(--size) / 7); /* –µ—â—ë –±–æ–ª—å—à–µ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö */
          height: calc(var(--size) / 14);
        }
        .wheel-section {
          padding: 40px 15px;
        }
      }
    </style>
  </head>
  <body>
    <header class="header">
      <div class="header__container">
        <div class="header__brand">
          <img src="images/logo.jpg" alt="VERTUU RENT" class="header__logo" />
          <span class="header__title">VERTUU RENT</span>
        </div>
      </div>
    </header>

    <main class="page">
      <section class="roulette">
        <div class="roulette__container">
          <!-- –ë–ª–æ–∫ –ø–æ–¥–ø–∏—Å–∫–∏ -->
          <div class="roulette__card" id="subscriptionCard">
            <h1 class="roulette__title">
              <span class="roulette__icon">üéÅ</span>
              –ö–æ–ª–µ—Å–æ —Ñ–æ—Ä—Ç—É–Ω—ã
            </h1>

            <p class="roulette__description">
              –ß—Ç–æ–±—ã –∫—Ä—É—Ç–∏—Ç—å –∫–æ–ª–µ—Å–æ, –ø–æ–¥–ø–∏—à–∏—Å—å –Ω–∞ –Ω–∞—à Telegram-–∫–∞–Ω–∞–ª.
            </p>

            <div class="roulette__actions">
              <a
                href="https://t.me/vertuu_rent"
                class="roulette__button roulette__button--primary"
                target="_blank"
                rel="noopener noreferrer"
                id="subscribeBtn"
              >
                –ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –≤ Telegram
              </a>

              <button
                type="button"
                class="roulette__button roulette__button--secondary"
                id="checkBtn"
                disabled
              >
                –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É
              </button>
            </div>

            <label class="roulette__checkbox">
              <input
                type="checkbox"
                class="roulette__checkbox-input"
                id="confirmCheckbox"
                disabled
              />
              <span class="roulette__checkbox-text"> –Ø –ø–æ–¥–ø–∏—Å–∞–ª—Å—è(–ª–∞—Å—å) </span>
            </label>
          </div>

          <!-- –ö–æ–ª–µ—Å–æ ‚Äî —Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–æ -->
          <div class="wheel-section" id="wheelSection" style="display: none">
            <div class="deal-wheel">
              <ul class="spinner"></ul>
              <div class="ticker"></div>
              <button class="btn-spin">–ò—Å–ø—ã—Ç–∞–π —É–¥–∞—á—É</button>
            </div>
          </div>
        </div>
      </section>

      <section class="give">
        <div class="give__container">
          <div class="give__card">
            <h2 class="give__title">–ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å –ø—Ä–∏–∑</h2>
            <ol class="give__steps">
              <li class="give__step">–ü–æ–¥–ø–∏—à–∏—Å—å –Ω–∞ –∫–∞–Ω–∞–ª –∏ –ø—Ä–æ–≤–µ—Ä—å –ø–æ–¥–ø–∏—Å–∫—É.</li>
              <li class="give__step">–ö—Ä—É—Ç–∏ –∫–æ–ª–µ—Å–æ.</li>
              <li class="give__step">–°–¥–µ–ª–∞–π —Å–∫—Ä–∏–Ω—à–æ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞.</li>
              <li class="give__step">
                –û—Ç–ø—Ä–∞–≤—å —Å–∫—Ä–∏–Ω –≤ TG:
                <a
                  href="https://t.me/orenda_admin"
                  class="give__link"
                  target="_blank"
                  rel="noopener noreferrer"
                >
                  @orenda_admin
                </a>
              </li>
            </ol>
          </div>
        </div>
      </section>
    </main>

    <script>
      // –õ–æ–≥–∏–∫–∞ –ø–æ–¥–ø–∏—Å–∫–∏
      const subscribeBtn = document.getElementById("subscribeBtn");
      const confirmCheckbox = document.getElementById("confirmCheckbox");
      const checkBtn = document.getElementById("checkBtn");
      const subscriptionCard = document.getElementById("subscriptionCard");
      const wheelSection = document.getElementById("wheelSection");

      confirmCheckbox.disabled = true;
      checkBtn.disabled = true;

      subscribeBtn.addEventListener("click", () => {
        confirmCheckbox.disabled = false;
      });

      confirmCheckbox.addEventListener("change", () => {
        checkBtn.disabled = !confirmCheckbox.checked;
      });

      checkBtn.addEventListener("click", () => {
        if (confirmCheckbox.checked) {
          subscriptionCard.style.display = "none";
          wheelSection.style.display = "flex";
          setupWheel();
        }
      });

      // === –ü—Ä–∏–∑—ã —Å —à–∞–Ω—Å–∞–º–∏ ===
      const prizes = [
        { text: "X2", probability: 59.99 },
        { text: "X3", probability: 25 },
        { text: "X5", probability: 10 },
        { text: "X10", probability: 4 },
        { text: "50$", probability: 1 },
        { text: "100$", probability: 0.01 },
      ];

      const getWeightedPrize = () => {
        let random = Math.random() * 100;
        let cumulative = 0;
        for (let prize of prizes) {
          cumulative += prize.probability;
          if (random <= cumulative) return prize.text;
        }
        return prizes[prizes.length - 1].text;
      };

      const wheel = document.querySelector(".deal-wheel");
      const spinner = wheel.querySelector(".spinner");
      const trigger = wheel.querySelector(".btn-spin");
      const ticker = wheel.querySelector(".ticker");

      const prizeSlice = 360 / prizes.length;
      const prizeOffset = Math.floor(180 / prizes.length);
      const spinClass = "is-spinning";
      const selectedClass = "selected";
      const spinnerStyles = window.getComputedStyle(spinner);

      let tickerAnim;
      let rotation = 0;
      let currentSlice = 0;
      let prizeNodes = [];
      let winningPrizeIndex = 0;

      const createPrizeNodes = () => {
        prizes.forEach(({ text }, i) => {
          const rotation = prizeSlice * i * -1 - prizeOffset;
          spinner.insertAdjacentHTML(
            "beforeend",
            `<li class="prize" style="--rotate: ${rotation}deg">
          <span class="text">${text}</span>
        </li>`
          );
        });
      };

      const createConicGradient = () => {
        const colors = [
          "hsl(197 30% 43%)",
          "hsl(173 58% 39%)",
          "hsl(43 74% 66%)",
          "hsl(27 87% 67%)",
          "hsl(12 76% 61%)",
          "hsl(350 60% 52%)",
        ];
        spinner.setAttribute(
          "style",
          `background: conic-gradient(from -90deg, ${prizes
            .map(
              ({}, i) =>
                `${colors[i % colors.length]} 0 ${
                  (100 / prizes.length) * (prizes.length - i)
                }%`
            )
            .reverse()
            .join(", ")});`
        );
      };

      const setupWheel = () => {
        createConicGradient();
        createPrizeNodes();
        prizeNodes = wheel.querySelectorAll(".prize");

        // === –ê–ù–¢–ò-–ê–ë–£–ó: –ø—Ä–æ–≤–µ—Ä–∫–∞ localStorage ===
        if (localStorage.getItem("hasSpun") === "true") {
          trigger.disabled = true;
          trigger.textContent = "–í—ã —É–∂–µ –∫—Ä—É—Ç–∏–ª–∏ –∫–æ–ª–µ—Å–æ";

          const lastPrize = localStorage.getItem("lastPrize");
          if (lastPrize) {
            const index = prizes.findIndex((p) => p.text === lastPrize);
            if (index !== -1) {
              prizeNodes[index].classList.add(selectedClass);
            }
          }
        }
      };

      const spinertia = (min, max) =>
        Math.floor(Math.random() * (max - min + 1)) + min;

      const runTickerAnimation = () => {
        const values = spinnerStyles.transform
          .split("(")[1]
          .split(")")[0]
          .split(",");
        const a = values[0];
        const b = values[1];
        let rad = Math.atan2(b, a);
        if (rad < 0) rad += 2 * Math.PI;
        const angle = Math.round(rad * (180 / Math.PI));
        const slice = Math.floor(angle / prizeSlice);

        if (currentSlice !== slice) {
          ticker.style.animation = "none";
          setTimeout(() => (ticker.style.animation = null), 10);
          currentSlice = slice;
        }
        tickerAnim = requestAnimationFrame(runTickerAnimation);
      };

      trigger.addEventListener("click", () => {
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ ‚Äî —É–∂–µ –∫—Ä—É—Ç–∏–ª–∏?
        if (localStorage.getItem("hasSpun") === "true") return;

        trigger.disabled = true;

        const winningPrize = getWeightedPrize();
        winningPrizeIndex = prizes.findIndex((p) => p.text === winningPrize);

        const extraSpins = 5 + Math.floor(Math.random() * 3);
        rotation =
          winningPrizeIndex * prizeSlice + prizeOffset + extraSpins * 360;

        prizeNodes.forEach((p) => p.classList.remove(selectedClass));
        wheel.classList.add(spinClass);
        spinner.style.setProperty("--rotate", rotation);
        ticker.style.animation = "none";

        runTickerAnimation();

        // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å–ø–∏–Ω –∏ –ø—Ä–∏–∑
        localStorage.setItem("hasSpun", "true");
        localStorage.setItem("lastPrize", winningPrize);
      });

      spinner.addEventListener("transitionend", () => {
        cancelAnimationFrame(tickerAnim);
        rotation %= 360;

        // –ü–æ–¥—Å–≤–µ—á–∏–≤–∞–µ–º –∏–º–µ–Ω–Ω–æ –≤—ã–ø–∞–≤—à–∏–π –ø—Ä–∏–∑
        prizeNodes.forEach((p) => p.classList.remove(selectedClass));
        prizeNodes[winningPrizeIndex].classList.add(selectedClass);

        wheel.classList.remove(spinClass);
        spinner.style.setProperty("--rotate", rotation);

        // –§–∏–Ω–∞–ª—å–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞
        trigger.disabled = true;
        trigger.textContent = "–í—ã —É–∂–µ –∫—Ä—É—Ç–∏–ª–∏ –∫–æ–ª–µ—Å–æ";
      });
    </script>
  </body>
</html>
